
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Packet Ripper is a tool for intercepting and modifying network packets.">
      
      
        <meta name="author" content="Packet Ripper">
      
      
        <link rel="canonical" href="https://docs.packetripper.live/user-guide/injector/flags/">
      
      
        <link rel="prev" href="../launch-methods/">
      
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Flags - Packet Ripper</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cloaking-and-manual-mapping-options-in-packet-ripper" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Packet Ripper" class="md-header__button md-logo" aria-label="Packet Ripper" data-md-component="logo">
      
  <img src="../../../images/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Packet Ripper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Flags
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting-started/" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  User Guide

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Packet Ripper" class="md-nav__button md-logo" aria-label="Packet Ripper" data-md-component="logo">
      
  <img src="../../../images/favicon.png" alt="logo">

    </a>
    Packet Ripper
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parsers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parsers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hex-editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hex-Editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../logger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Injector
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Injector
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../injecting-methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Injecting Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../launch-methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launch Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Flags
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Flags
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloaking-options" class="md-nav__link">
    <span class="md-ellipsis">
      Cloaking Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cloaking Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inj_erase_header" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_ERASE_HEADER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_fake_header" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_FAKE_HEADER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_unlink_from_peb" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_UNLINK_FROM_PEB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_thread_create_cloaked" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_THREAD_CREATE_CLOAKED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_scramble_dll_name" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_SCRAMBLE_DLL_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_load_dll_copy" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_LOAD_DLL_COPY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_hijack_handle" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_HIJACK_HANDLE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-mapping-options" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Mapping Options
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-mapping-options_1" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Mapping Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Mapping Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inj_mm_clean_data_dir" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_CLEAN_DATA_DIR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_resolve_imports" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RESOLVE_IMPORTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_resolve_delay_imports" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RESOLVE_DELAY_IMPORTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_execute_tls" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_EXECUTE_TLS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_enable_exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_ENABLE_EXCEPTIONS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_set_page_protections" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_SET_PAGE_PROTECTIONS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_init_security_cookie" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_INIT_SECURITY_COOKIE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_run_dll_main" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RUN_DLL_MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_run_under_ldr_lock" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RUN_UNDER_LDR_LOCK
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_shift_module_base" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_SHIFT_MODULE_BASE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloaking-options" class="md-nav__link">
    <span class="md-ellipsis">
      Cloaking Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cloaking Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inj_erase_header" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_ERASE_HEADER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_fake_header" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_FAKE_HEADER
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_unlink_from_peb" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_UNLINK_FROM_PEB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_thread_create_cloaked" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_THREAD_CREATE_CLOAKED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_scramble_dll_name" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_SCRAMBLE_DLL_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_load_dll_copy" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_LOAD_DLL_COPY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_hijack_handle" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_HIJACK_HANDLE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-mapping-options" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Mapping Options
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-mapping-options_1" class="md-nav__link">
    <span class="md-ellipsis">
      Manual Mapping Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Mapping Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#inj_mm_clean_data_dir" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_CLEAN_DATA_DIR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_resolve_imports" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RESOLVE_IMPORTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_resolve_delay_imports" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RESOLVE_DELAY_IMPORTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_execute_tls" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_EXECUTE_TLS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_enable_exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_ENABLE_EXCEPTIONS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_set_page_protections" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_SET_PAGE_PROTECTIONS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_init_security_cookie" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_INIT_SECURITY_COOKIE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_run_dll_main" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RUN_DLL_MAIN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_run_under_ldr_lock" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_RUN_UNDER_LDR_LOCK
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inj_mm_shift_module_base" class="md-nav__link">
    <span class="md-ellipsis">
      INJ_MM_SHIFT_MODULE_BASE
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="cloaking-and-manual-mapping-options-in-packet-ripper">Cloaking and Manual Mapping Options in Packet Ripper</h1>
<p>Packet Ripper offers a range of cloaking and manual mapping options to enhance the stealthiness and effectiveness of the injection process. These options provide users with the flexibility to customize the injection behavior based on specific requirements and scenarios.</p>
<h2 id="introduction">Introduction</h2>
<p>Cloaking and manual mapping options in Packet Ripper allow users to manipulate various aspects of the injection process, from altering DLL headers to executing specific callbacks and initializing security mechanisms. By understanding and leveraging these options, users can enhance the stealthiness and resilience of their injection techniques.</p>
<h2 id="cloaking-options">Cloaking Options</h2>
<p>Cloaking options in Packet Ripper focus on modifying the characteristics of the injected DLL to evade detection and analysis by anti-cheat systems and security software. Flags such as INJ_ERASE_HEADER and INJ_FAKE_HEADER allow users to manipulate the DLL's header, while others like INJ_UNLINK_FROM_PEB and INJ_THREAD_CREATE_CLOAKED aim to make the injection process more stealthy and difficult to detect.</p>
<h3 id="inj_erase_header">INJ_ERASE_HEADER</h3>
<ul>
<li><strong>Description</strong>: Replaces the first 0x1000 bytes of the DLL with zeros, effectively erasing its header.</li>
<li><strong>Advantages</strong>:</li>
<li>Helps evade detection by altering the DLL's header, making it appear as if it lacks a valid PE header.</li>
<li><strong>Considerations</strong>:</li>
<li>May lead to instability or crashes if critical header information is overwritten.</li>
<li>Detection may still be possible through other means, such as behavioral analysis.</li>
</ul>
<h3 id="inj_fake_header">INJ_FAKE_HEADER</h3>
<ul>
<li><strong>Description</strong>: Replaces the DLL's header with the header of the <code>ntdll.dll</code>.</li>
<li><strong>Advantages</strong>:</li>
<li>Mimics the header of a legitimate system DLL, making the injected DLL appear more authentic.</li>
<li><strong>Considerations</strong>:</li>
<li>May trigger detection mechanisms that compare DLL headers with known system DLLs.</li>
<li>Requires careful handling to ensure compatibility with the target environment.</li>
</ul>
<h3 id="inj_unlink_from_peb">INJ_UNLINK_FROM_PEB</h3>
<ul>
<li><strong>Description</strong>: Unlinks the module from the process environment block (PEB).</li>
<li><strong>Advantages</strong>:</li>
<li>Removes traces of the injected module from process-related data structures, reducing detectability.</li>
<li><strong>Considerations</strong>:</li>
<li>Ignored when manually mapping, limiting its effectiveness in certain scenarios.</li>
<li>May be ineffective against advanced detection techniques that analyze memory contents.</li>
</ul>
<h3 id="inj_thread_create_cloaked">INJ_THREAD_CREATE_CLOAKED</h3>
<ul>
<li><strong>Description</strong>: Passes certain flags to <code>NtCreateThreadEx</code> to make the thread creation more stealthy.</li>
<li><strong>Advantages</strong>:</li>
<li>Enhances the stealthiness of thread creation, making it harder to detect by anti-cheat systems.</li>
<li><strong>Considerations</strong>:</li>
<li>Requires the launch method to be NtCreateThreadEx; ignored otherwise.</li>
<li>May increase the complexity of the injection process and lead to compatibility issues.</li>
</ul>
<h3 id="inj_scramble_dll_name">INJ_SCRAMBLE_DLL_NAME</h3>
<ul>
<li><strong>Description</strong>: Randomizes the DLL name on disk before injecting it.</li>
<li><strong>Advantages</strong>:</li>
<li>Helps obfuscate the injected DLL's identity, making it harder to attribute to the injector.</li>
<li><strong>Considerations</strong>:</li>
<li>May cause confusion during debugging or troubleshooting.</li>
<li>Requires additional measures to maintain track of injected DLLs for management purposes.</li>
</ul>
<h3 id="inj_load_dll_copy">INJ_LOAD_DLL_COPY</h3>
<ul>
<li><strong>Description</strong>: Loads a copy of the DLL from the <code>%temp%</code> directory.</li>
<li><strong>Advantages</strong>:</li>
<li>Prevents tampering with the original DLL file, preserving its integrity.</li>
<li><strong>Considerations</strong>:</li>
<li>May raise suspicion if the injected DLL suddenly appears in the temporary directory.</li>
<li>Requires sufficient permissions to create and execute files in the temporary directory.</li>
</ul>
<h3 id="inj_hijack_handle">INJ_HIJACK_HANDLE</h3>
<ul>
<li><strong>Description</strong>: Tries to hijack a handle from another process instead of using <code>OpenProcess</code>.</li>
<li><strong>Advantages</strong>:</li>
<li>Avoids direct interaction with the target process, reducing the likelihood of detection.</li>
<li><strong>Considerations</strong>:</li>
<li>Relies on the availability of suitable handles in other processes, which may not always be feasible.</li>
<li>May lead to unpredictable behavior if the hijacked handle becomes invalid or inaccessible.</li>
</ul>
<h2 id="manual-mapping-options">Manual Mapping Options</h2>
<p>Manual mapping options in Packet Ripper provide advanced techniques for injecting code into the target process's memory space. These options offer granular control over the injection process, allowing users to resolve imports, execute callbacks, and initialize security features manually. Flags such as INJ_MM_SET_PAGE_PROTECTIONS and INJ_MM_SHIFT_MODULE_BASE enable users to fine-tune the injection behavior for optimal performance and stealthiness.</p>
<h2 id="manual-mapping-options_1">Manual Mapping Options</h2>
<h3 id="inj_mm_clean_data_dir">INJ_MM_CLEAN_DATA_DIR</h3>
<ul>
<li><strong>Description</strong>: Removes data from the DLL's PE header.</li>
<li><strong>Advantages</strong>:</li>
<li>Reduces the footprint of the injected DLL, minimizing the likelihood of detection.</li>
<li><strong>Considerations</strong>:</li>
<li>Ignored if INJ_MM_SET_PAGE_PROTECTIONS is set, limiting its applicability in certain scenarios.</li>
<li>May interfere with the functionality of the injected DLL if critical data is removed.</li>
</ul>
<h3 id="inj_mm_resolve_imports">INJ_MM_RESOLVE_IMPORTS</h3>
<ul>
<li><strong>Description</strong>: Resolves DLL imports.</li>
<li><strong>Advantages</strong>:</li>
<li>Ensures that the injected DLL has access to all required external functions and libraries.</li>
<li><strong>Considerations</strong>:</li>
<li>Increases the size of the injected code and may prolong the injection process.</li>
<li>Requires access to the target process's address space to resolve imports successfully.</li>
</ul>
<h3 id="inj_mm_resolve_delay_imports">INJ_MM_RESOLVE_DELAY_IMPORTS</h3>
<ul>
<li><strong>Description</strong>: Resolves delayed imports.</li>
<li><strong>Advantages</strong>:</li>
<li>Handles imports that are resolved dynamically at runtime, ensuring smooth execution of the injected code.</li>
<li><strong>Considerations</strong>:</li>
<li>Adds complexity to the injection process and may introduce overhead.</li>
<li>Requires careful handling to ensure compatibility with the target environment.</li>
</ul>
<h3 id="inj_mm_execute_tls">INJ_MM_EXECUTE_TLS</h3>
<ul>
<li><strong>Description</strong>: Executes TLS callbacks and initializes static TLS data.</li>
<li><strong>Advantages</strong>:</li>
<li>Ensures proper initialization of Thread Local Storage (TLS) data, maintaining the integrity of the injected code.</li>
<li><strong>Considerations</strong>:</li>
<li>May increase the execution time of the injection process, especially if multiple TLS callbacks are present.</li>
<li>Requires thorough testing to verify compatibility with the target process's TLS initialization routine.</li>
</ul>
<h3 id="inj_mm_enable_exceptions">INJ_MM_ENABLE_EXCEPTIONS</h3>
<ul>
<li><strong>Description</strong>: Enables exception handling.</li>
<li><strong>Advantages</strong>:</li>
<li>Improves the robustness of the injected code by allowing it to handle unexpected errors or exceptions.</li>
<li><strong>Considerations</strong>:</li>
<li>Adds overhead to the injection process and may impact performance.</li>
<li>Requires careful error handling to prevent unintended behavior or crashes.</li>
</ul>
<h3 id="inj_mm_set_page_protections">INJ_MM_SET_PAGE_PROTECTIONS</h3>
<ul>
<li><strong>Description</strong>: Sets page protections based on section characteristics.</li>
<li><strong>Advantages</strong>:</li>
<li>Enhances the security of the injected code by restricting access to certain memory regions.</li>
<li><strong>Considerations</strong>:</li>
<li>Overrides INJ_MM_CLEAN_DATA_DIR if set, limiting the effectiveness of data directory cleaning.</li>
<li>Requires thorough understanding of memory protection mechanisms to avoid unintended consequences.</li>
</ul>
<h3 id="inj_mm_init_security_cookie">INJ_MM_INIT_SECURITY_COOKIE</h3>
<ul>
<li><strong>Description</strong>: Initializes security cookie for buffer overrun protection.</li>
<li><strong>Advantages</strong>:</li>
<li>Strengthens the security posture of the injected code by mitigating buffer overflow vulnerabilities.</li>
<li><strong>Considerations</strong>:</li>
<li>Requires compiler support for security cookie generation and validation.</li>
<li>May increase the size of the injected code and impact performance.</li>
</ul>
<h3 id="inj_mm_run_dll_main">INJ_MM_RUN_DLL_MAIN</h3>
<ul>
<li><strong>Description</strong>: Executes DllMain; induces INJ_MM_RESOLVE_IMPORTS.</li>
<li><strong>Advantages</strong>:</li>
<li>Ensures proper initialization of the injected DLL, including module attachment and detachment.</li>
<li><strong>Considerations</strong>:</li>
<li>May trigger unwanted side effects if the DllMain function is not implemented correctly.</li>
<li>Requires thorough testing to verify compatibility with the target process's initialization routine.</li>
</ul>
<h3 id="inj_mm_run_under_ldr_lock">INJ_MM_RUN_UNDER_LDR_LOCK</h3>
<ul>
<li><strong>Description</strong>: Runs the DllMain under the loader lock.</li>
<li><strong>Advantages</strong>:</li>
<li>Provides synchronization and thread safety during DLL initialization, reducing the risk of concurrency issues.</li>
<li><strong>Considerations</strong>:</li>
<li>Requires careful handling to avoid deadlocks or race conditions.</li>
<li>May introduce performance overhead, especially in multi-threaded environments.</li>
</ul>
<h3 id="inj_mm_shift_module_base">INJ_MM_SHIFT_MODULE_BASE</h3>
<ul>
<li><strong>Description</strong>: Shifts the module base by a random offset.</li>
<li><strong>Advantages</strong>:</li>
<li>Mitigates address space layout randomization (ASLR) bypass techniques by introducing additional entropy.</li>
<li><strong>Considerations</strong>:</li>
<li>May lead to compatibility issues with certain DLLs or modules that rely on fixed memory addresses.</li>
<li>Requires careful handling to ensure proper alignment and avoid memory conflicts.</li>
</ul>
<h2 id="summary">Summary</h2>
<p>Cloaking and manual mapping options in Packet Ripper empower users to customize the injection process according to their specific needs and objectives. Whether it's erasing DLL headers to evade detection or executing TLS callbacks for initialization, these options offer a comprehensive toolkit for enhancing the stealthiness and effectiveness of injection techniques in various scenarios.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.indexes", "navigation.top", "content.code.copy", "content.code.highlight", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>